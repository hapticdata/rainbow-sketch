define(["require","exports","module","../math/mathUtils"],function(t,e,n){var i=t("../math/mathUtils"),r=function(t,e){this.a=t,this.b=e};r.prototype={closestLineTo:function(t){var e=t.a.sub(t.b);if(e.isZeroVector())return new r.LineIntersection(r.LineIntersection.Type.NON_INTERSECTING);var n=this.b.sub(this.a);if(n.isZeroVector())return new r.LineIntersection(r.LineIntersection.Type.NON_INTERSECTING);var s=this.a.sub(t.a),o=s.x*e.x+s.y*e.y+s.z*e.z,a=e.x*n.x+e.y*n.y+e.z*n.z,u=s.x*n.x+s.y*n.y+s.z*n.z,h=e.x*e.x+e.y*e.y+e.z*e.z,c=n.x*n.x+n.y*n.y+n.z*n.z,l=c*h-a*a;if(Math.abs(l)<i.EPS)return new r.LineIntersection(r.LineIntersection.Type.NON_INTERSECTING);var d=o*a-u*h,f=d/l,p=(o+a*f)/h,m=this.a.add(n.scaleSelf(f)),g=t.a.add(e.scaleSelf(p));return new r.LineIntersection(r.LineIntersection.Type.INTERSECTING,new r(m,g),f,p)},closestPointTo:function(t){var e=this.b.sub(this.a),n=t.sub(this.a).dot(e)/e.magSquared();return 0>n?this.a.copy():n>1?this.b.copy():this.a.add(e.scaleSelf(n))},copy:function(){return new r(this.a.copy(),this.b.copy())},equals:function(t){return this==t?!0:typeof t!=r?!1:(this.a.equals(t.a)||this.a.equals(l.b))&&(this.b.equals(l.b)||this.b.equals(l.a))},getDirection:function(){return this.b.sub(this.a).normalize()},getLength:function(){return this.a.distanceTo(this.b)},getLengthSquared:function(){return this.a.distanceToSquared(this.b)},getMidPoint:function(){return this.a.add(this.b).scaleSelf(.5)},getNormal:function(){return this.b.cross(this.a)},hasEndPoint:function(t){return this.a.equals(t)||this.b.equals(t)},offsetAndGrowBy:function(t,e,n){var i=this.getMidPoint(),r=this.getDirection(),s=this.a.cross(r).normalize();return void 0!==n&&0>i.sub(n).dot(s)&&s.invert(),s.normalizeTo(t),this.a.addSelf(s),this.b.addSelf(s),r.scaleSelf(e),this.a.subSelf(r),this.b.addSelf(r),this},set:function(t,e){return this.a=t,this.b=e,this},splitIntoSegments:function(t,e,n){return r.splitIntoSegments(this.a,this.b,e,t,n)},toString:function(){return""+this.a+" -> "+(""+this.b)}},r.splitIntoSegments=function(t,e,n,i,r){void 0===i&&(i=[]),r&&i.push(t.copy());var s=t.distanceTo(e);if(s>n)for(var o=t.copy(),a=e.sub(t).limit(n);s>n;)o.addSelf(a),i.push(o.copy()),s-=n;return i.push(e.copy()),i},r.LineIntersection=function(t,e,n,i){this.type=t,void 0===n&&(n=0),void 0===i&&(i=0),this.line=e,this.coeff=[n,i]},r.LineIntersection.prototype={getCoefficient:function(){return this.coeff},getLength:function(){return void 0===this.line?void 0:this.line.getLength()},getLine:function(){return void 0===this.line?void 0:this.line.copy()},getType:function(){return this.type},isIntersectionInside:function(){return this.type==r.LineIntersection.Type.INTERSECTING&&this.coeff[0]>=0&&1>=this.coeff[0]&&this.coeff[1]>=0&&1>=this.coeff[1]},toString:function(){return"type: "+this.type+" line: "+this.line}},r.LineIntersection.Type={NON_INTERSECTING:0,INTERSECTING:1},n.exports=r});