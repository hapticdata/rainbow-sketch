define(["require","exports","module","../internals","./Vec3D","./mesh/TriangleMesh"],function(t,e,n){function i(t){throw Error("Missing parameter: "+t)}var r=t("../internals").extend,s=t("./Vec3D"),o=t("./mesh/TriangleMesh"),a=function(t,e,n,r,o){function a(t,e,n,i,r){s.apply(u,[t]),u.dir=e.getNormalized(),u.radiusNorth=n,u.radiusSouth=i,u.length=r}var u=this;"object"==typeof t&&1===arguments.length?a(t.pos||t.position||new s,t.dir||t.direction||i("direction"),t.rNorth||t.radiusNorth||i("radiusNorth"),t.rSouth||t.radiusSouth||i("radiusSouth"),t.len||t.length||i("length")):a(t,e,n,r,o)};r(a,s),a.prototype.toMesh=function(){var t={mesh:void 0,steps:0/0,thetaOffset:0,topClosed:!0,bottomClosed:!0};if(1==arguments.length)if("object"==typeof arguments[0]){var e=arguments[0];t.mesh=e.mesh,t.steps=e.steps||e.resolution||e.res,t.thetaOffset=e.thetaOffset||t.thetaOffset,t.topClosed=e.topClosed||t.topClosed,t.bottomClosed=e.bottomClosed||t.bottomClosed}else t.steps=arguments[0];else 2==arguments.length?(t.steps=arguments[0],t.thetaOffset=arguments[1]):5==arguments.length&&(t.mesh=arguments[0],t.steps=arguments[1],t.thetaOffset=arguments[2],t.topClosed=arguments[3],t.bottomClosed=arguments[4]);var n=this.add(.01,.01,.01),i=n.cross(this.dir.getNormalized()).normalize(),r=this.dir.scale(.5*this.length),s=this.sub(r),a=this.add(r),u=[],h=[],c=2*Math.PI/t.steps,l=0,d=1;for(l=0;t.steps>l;l++){var f=l*c+t.thetaOffset,p=i.getRotatedAroundAxis(this.dir,f);u[l]=p.scale(this.radiusSouth).addSelf(s),h[l]=p.scale(this.radiusNorth).addSelf(a)}var m=2*t.steps+2,g=2*t.steps+(t.topClosed?t.steps:0)+(t.bottomClosed?t.steps:0),_=t.mesh||new o("cone",m,g);for(l=0;t.steps>l;l++,d++)d==t.steps&&(d=0),_.addFace(u[l],h[l],u[d],void 0,void 0,void 0,void 0),_.addFace(u[d],h[l],h[d],void 0,void 0,void 0,void 0),t.bottomClosed&&_.addFace(s,u[l],u[d],void 0,void 0,void 0,void 0),t.topClosed&&_.addFace(h[l],a,h[d],void 0,void 0,void 0,void 0);return _},n.exports=a});