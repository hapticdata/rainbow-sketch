define(["require","exports","module","../Vec3D","./TriangleMesh"],function(t,e,i){var n=t("../Vec3D"),r=t("./TriangleMesh"),s=function(t){this.points=void 0===t?[]:t;for(var e=0;4>e;e++)for(var i=0;4>i;i++)this.points[e][i]=new n};s.prototype={computePointAt:function(t,e){return this.computePointAt(t,e,this.points)},set:function(t,e,i){return this.points[e][t].set(i),this},toMesh:function(t,e){var i,n;void 0===e?(i=new r,n=t):(i=t,n=e);for(var s=Array(n+1),o=Array(n+1),a=1/n,u=0;n>=u;u++){for(var h=0;n>=h;h++){var c=this.computePointAt(h*a,u*a,this.points);h>0&&u>0&&(i.addFace(c,s[h-1],o[h-1]),i.addFace(c,o[h-1],o[h])),s[h]=c}var l=o;o=s,s=l}return i}},s.computePointAt=function(t,e,i){var r=1-t,s=3*r*r*t,o=r*r*r,a=t*t,u=1-e,h=3*e*e,c=3*u*u,l=u*u*u,d=e*e*e,f=3*r*a,p=t*a,m=u*h,g=c*e,_=i[0],y=i[1],x=i[2],v=i[3],b=o*(_[0].x*l+_[1].x*g+_[2].x*m+_[3].x*d)+s*(y[0].x*l+y[1].x*g+y[2].x*m+y[3].x*d)+f*(x[0].x*l+x[1].x*g+x[2].x*m+x[3].x*d)+p*(v[0].x*l+v[1].x*g+v[2].x*m+v[3].x*d),w=o*(_[0].y*l+_[1].y*g+_[2].y*m+_[3].y*d)+s*(y[0].y*l+y[1].y*g+y[2].y*m+y[3].y*d)+f*(x[0].y*l+x[1].y*g+x[2].y*m+x[3].y*d)+p*(v[0].y*l+v[1].y*g+v[2].y*m+v[3].y*d),E=o*(_[0].z*l+_[1].z*g+_[2].z*m+_[3].z*d)+s*(y[0].z*l+y[1].z*g+y[2].z*m+y[3].z*d)+f*(x[0].z*l+x[1].z*g+x[2].z*m+x[3].z*d)+p*(v[0].z*l+v[1].z*g+v[2].z*m+v[3].z*d);return new n(b,w,E)},i.exports=s});