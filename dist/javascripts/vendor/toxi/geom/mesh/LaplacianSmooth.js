define(["../../internals","../Vec3D","./DefaultSelector","./meshCommon"],function(t,e,i,n){function r(r,s){function o(t,e){var i=u.vertexMap.get(e);void 0===i?console.log("missing vertex"):i.set(t)}var a,u,h,c,l,d,f,p,m,g,_,y;if("function"==typeof r.addFace&&(r=new i(r).selectVertices()),a=r.getSelection(),u=r.getMesh(),"function"!=typeof u.subdivide)throw Error("This filter requires a WETriangleMesh");for(g=a.length,f=0;s>f;f++){for(h=new t.LinkedMap(n.TriangleMesh.__vertexKeyGenerator),p=0;g>p;p++){for(c=a[f],l=new e,d=c.getNeighbors(),_=d.length,console.log("neighbors.length: "+_),m=0;_>m;m++)l.addSelf(d[m]);l.scaleSelf(1/_),h.put(c,l)}y=h.size(),h.each(o),u.rebuildIndex()}u.computeFaceNormals(),u.computeVertexNormals()}var s=function(){};return s.prototype={filter:r},s.filter=r,s});