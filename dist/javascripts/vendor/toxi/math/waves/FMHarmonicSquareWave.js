define(["require","exports","module","../../internals","./AbstractWave"],function(t,e,i){var n=t("../../internals").extend,s=t("./AbstractWave"),r=function(t,e,i,n,r){this.maxHarmonics=3,"number"==typeof i?(void 0===r&&(r=new ConstantWave(0)),s.apply(this,[t,e,i,n]),this.fmod=r):(s.apply(this,[t,e]),this.fmod=i)};n(r,s),r.prototype.getClass=function(){return"FMHarmonicSquareWave"},r.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},r.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},r.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},r.prototype.update=function(){this.value=0;for(var t=1;this.maxHarmonics>=t;t+=2)this.value+=1/t*Math.sin(t*this.phase);return this.value*=this.amp,this.value+=this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},i.exports=r});